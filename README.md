Course work on programming. Variant 4.5 - LZ78.
http://cpct.sibsutis.ru/~eperyshkova/downloads/prog/2014_2015/s2/prog_s2_cw_metod.pdf
## ВАРИАНТ 4.5 Алгоритм Лемпела – Зива (Lempel – Ziv) LZ78
# Задание
Реализовать программу lz78compress сжатия текстовых файлов на английском языке алгоритмом Зива-Лемпела. Сжатие осуществляется с аргументом командной строки -c (compress), а распаковка – с аргументом -d (decompress). Опция -o указывает имя выходного файла. Вызов программы с аргументами командрой строки может выглядить следующим образом:

$ lz78compress -c -o file.lz78 file.txt # сжатие file.txt в file.lz78

$ lz78compress -d -o file1.txt file.lz78 # распаковка file.lz78 в file1.txt

# Критерии оценки

Оценка «хорошо»: реализован алгоритм сжатия, размер словаря 65536 элементов, при переполнении словаря он полностью сбрасывается.

Оценка «отлично»: реализован алгоритм сжатия, размер словаря может быть задан пользователем, при переполнении словаря удаляется наименее часто используемая фраза. Дополнительным плюсом будет использование кодов переменной длины (размер ссылки на словарь сначала 1 байт, когда 1 байт переполняется – 2 байта и т.д.).

# Указание к выполнению задания
В алгоритме LZ78 используется словарь из уже просмотренных фраз, который в процессе сжатия постоянно пополняется. При старте алгоритма этот словарь содержит только одну пустую строку (строку длины ноль). Алгоритм считывает символы сообщения до тех пор, пока накапливаемая подстрока входит целиком в одну из фраз словаря. Как только эта строка перестанет соответствовать хотя бы одной фразе словаря, алгоритм генерирует код, состоящий из индекса строки в словаре, которая до последнего введенного символа содержала входную строку, и символа, нарушившего совпадение. Затем в словарь добавляется полученная подстрока:

X = <номер строки из словаря><символ, нарушивший совпадение>.

Например, пусть мы кодируем следующий текст:”ппр”. Заносим в словарь первый символ ‘п’ и начинаем поиск новой фразы, для этого считываем следующий символ (‘п’). Поскольку он совпадает с фразой из словаря, считываем очередной символ. Получившейся фразы ‘пр’ нет в словаре – в соответствии с алгоритмом генерируем код для нее и записываем ее в словарь.

Если словарь уже заполнен, то из него предварительно удаляют наиболее редко используемую фразу либо очищают полностью. Ключевым для размера получаемых кодов является размер словаря во фразах, потому что каждый код при кодировании по методу LZ78 содержит номер фразы в словаре. Из последнего следует, что эти коды имеют постоянную длину, равную округленному в большую сторону двоичному логарифму размера словаря плюс количество бит в байт-коде ASCII. Рассмотрим алгоритм на примере. Пусть нам необходимо закодировать строку: «про проверку и проведение проводки». Пошаговый алгоритм кодирования представлен на рисунке 26.

0,‘п’|0,‘р’|0,‘о’|0,‘ ’|1,‘р’|3,‘в’|0,‘е’|2,‘к’|0,‘у’|4,‘и’|4,‘п’|2,‘о’|0,‘в’|7,‘д’|7,‘н’|0,‘и’|7,‘ ’|
5,‘о’|13,‘о’|0,‘д’|0,‘и’

# Рисунок 26. Пошаговый алгоритм кодирования
Строка Фраза, добавляемая в словарь, Код
 
про проверку и проведение проводки 0 - ‘’

про проверку и проведение проводки 1 - ‘п’ <0,‘п’>

про проверку и проведение проводки 2 - ‘р’ <0,‘р’>

про проверку и проведение проводки 3 - ‘о’ <0,‘о’>

про проверку и проведение проводки 4 - ‘ ’ <0,‘ ’>

про проверку и проведение проводки 5 - ‘пр’ <1,‘р’>

про проверку и проведение проводки 6 - ‘ов’ <3,‘в’>

про проверку и проведение проводки 7 - ‘е’ <0,‘е’>

про проверку и проведение проводки 8 - ‘рк’ <2,‘к’>

про проверку и проведение проводки 9 - ‘у’ <0,‘у’>

про проверку и проведение проводки 10 - ‘ и’ <4,‘и’>

про проверку и проведение проводки 11 - ‘ п’ <4,‘п’>

про проверку и проведение проводки 12 - ‘ро’ <2,‘о’>

про проверку и проведение проводки 13 - ‘в’ <0,‘в’>

про проверку и проведение проводки 14 - ‘ед’ <7,‘д’>

про проверку и проведение проводки 15 - ‘ен’ <7,‘н’>

про проверку и проведение проводки 16 - ‘и’ <0,‘и’>

про проверку и проведение проводки 17 - ‘е ’ <7,‘ ’>

про проверку и проведение проводки 18 - ‘про’ <5,‘о’>

про проверку и проведение проводки 19 - ‘во’ <13,‘о’>

про проверку и проведение проводки 20 - ‘д’ <0,‘д’>

про проверку и проведение проводки 21 - ‘к’ <0,‘к’>

про проверку и проведение проводки 22 - ‘и’ <0,‘и’> 

При декодировании данной строки словарь формируется динамически. Из входных данных считываются пары <номер фразы-начала из словаря, завершающий символ>, в выходные данные дописывается конкатенация этих двух элементов. Так например, пусть в качестве входных данных получен набор кодов: <0,‘п’><1,‘р’>. Считываем первый код - <0,‘п’>, поскольку номер фразыначала из словаря 0, что соответствует пустой строке, после конкатенации в словарь под номером 1 добавляется фраза ‘п’. Считываем очередной код-<1,‘р’>. В нем номер фразы-начала из словаря равен 1, что соответствует фразе ‘п’, в словарь под номером 2 мы добавляем конкатенацию этой фразы и символа ‘р’ – фразу ‘пр’
# Рисунок 27. Пошаговый процесс декодирования сообщения
Фрагмент закодированной строки Трактовка кода Фраза, добавляемая в словарь Раскодированная строка
<0,‘п’> - 1 - ‘п’ ‘п’
<0,‘р’> - 2 - ‘р’ ‘пр’
<0,‘о’> - 3 - ‘о’ ‘про’
<0,‘ ’> - 4 - ‘ ’ ‘про ’
<1,‘р’> 1→п:п+р 5 - ‘пр’ ‘про пр’
<3,‘в’> 3→о:о+в 6 - ‘ов’ ‘про пров’
<0,‘е’> - 7 - ‘е’ ‘про прове’
<2,‘к’> 2→р:р+к 8 - ‘рк’ ‘про проверк’
<0,‘у’> - 9 - ‘у’ ‘про проверку’
<4,‘и’> 4→ : +и 10 - ‘ и’ ‘про проверку и’
<4,‘п’> 4→ : +п 11 - ‘ п’ ‘про проверку и п’
<2,‘о’> 2→р:р+о 12 - ‘ро’ ‘про проверку и про’
<0,‘в’> - 13 - ‘в’ ‘про проверку и пров’
<7,‘д’> 7→е:е+д 14 - ‘ед’ ‘про проверку и провед’
<7,‘н’> 7→е:е+н 15 - ‘ен’ ‘про проверку и проведен’
<0,‘и’> - 16 - ‘и’ ‘про проверку и проеведени’
<7,‘ ’> 7→е:е+ 17 - ‘е ’ ‘про проверку и проведение ’
<5,‘о’> 5→пр:пр+о 18 - ‘про’ ‘про проверку и проведение про’
<13,‘о’> 13→в:в+о 19 - ‘во’ ‘про проверку и проведение прово’
<0,‘д’> - 20 - ‘д’ ‘про проверку и проведение провод’
<0,‘к’> - 21 - ‘к’ ‘про проверку и проведение проводк’
<0,‘и’> - 22 - ‘и’ про проверку и проведение проводки’ 
